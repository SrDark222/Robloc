<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
<title>Roblox Avatar 3D Clean - DK Edition Responsivo</title>
<style>
  /* Fonte Poppins do Google Fonts - clean e profissional */
  @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap');

  * {
    margin: 0; padding: 0; box-sizing: border-box;
    font-family: 'Poppins', sans-serif;
  }

  html, body {
    height: 100%;
    background-color: #000000;
    color: #ddd;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
    padding: 20px 12px 40px;
    user-select: none;
  }

  h1 {
    font-weight: 700;
    font-size: 2.4rem;
    margin-bottom: 24px;
    color: #00aaff;
    text-align: center;
  }

  #inputContainer {
    display: flex;
    width: 100%;
    max-width: 440px;
    margin-bottom: 20px;
  }

  #inputNick {
    flex: 1;
    padding: 14px 18px;
    border-radius: 14px 0 0 14px;
    border: none;
    background: rgba(255,255,255,0.05);
    color: #eee;
    font-size: 1.1rem;
    font-weight: 600;
    outline: none;
    box-shadow: 0 0 8px rgba(0, 170, 255, 0.2);
    transition: box-shadow 0.3s ease;
  }

  #inputNick::placeholder {
    color: #55aaff88;
  }

  #inputNick:focus {
    box-shadow: 0 0 15px #00aaffaa;
  }

  #btnLoad {
    padding: 14px 24px;
    border-radius: 0 14px 14px 0;
    background: #00aaff;
    border: none;
    color: #001522;
    font-weight: 700;
    font-size: 1.15rem;
    cursor: pointer;
    user-select: none;
    box-shadow: 0 0 12px #00aaffaa;
    transition: background 0.3s ease;
  }

  #btnLoad:hover {
    background: #007acc;
  }

  #canvas-container {
    width: 100%;
    max-width: 440px;
    height: 580px;
    border-radius: 16px;
    background: rgba(0, 170, 255, 0.07);
    box-shadow: 0 0 40px rgba(0, 170, 255, 0.12);
    backdrop-filter: blur(14px);
    overflow: hidden;
    position: relative;
  }

  #status {
    position: absolute;
    top: 12px;
    left: 16px;
    right: 16px;
    color: #00aaffcc;
    font-weight: 600;
    font-size: 1rem;
    text-shadow: 0 0 8px #00aaff66;
    z-index: 10;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  #animationControls {
    margin-top: 18px;
    display: flex;
    justify-content: center;
    gap: 14px;
    width: 100%;
    max-width: 440px;
  }

  .animBtn {
    flex: 1;
    background: rgba(0, 170, 255, 0.15);
    color: #00aaff;
    border-radius: 14px;
    padding: 12px 0;
    cursor: pointer;
    user-select: none;
    font-weight: 700;
    font-size: 1rem;
    text-align: center;
    transition: background 0.3s ease;
  }

  .animBtn:hover {
    background: rgba(0, 170, 255, 0.3);
  }

  /* RESPONSIVO MOBILE */

  @media (max-width: 480px) {
    body, html {
      padding: 16px 10px 36px;
    }

    h1 {
      font-size: 1.8rem;
      margin-bottom: 18px;
    }

    #inputNick {
      font-size: 1rem;
      padding: 12px 14px;
    }

    #btnLoad {
      font-size: 1rem;
      padding: 12px 18px;
    }

    #canvas-container {
      height: 400px;
      max-width: 100vw;
      border-radius: 12px;
      box-shadow: 0 0 24px rgba(0, 170, 255, 0.15);
    }

    #status {
      font-size: 0.85rem;
      top: 8px;
      left: 10px;
      right: 10px;
    }

    #animationControls {
      gap: 10px;
      max-width: 100vw;
    }

    .animBtn {
      font-size: 0.9rem;
      padding: 10px 0;
      border-radius: 12px;
    }
  }
</style>
</head>
<body>

<h1>Roblox Avatar 3D Clean - DK Edition Responsivo</h1>
<div id="inputContainer">
  <input id="inputNick" type="text" placeholder="Cola o nick do player aqui" autocomplete="off" autocorrect="off" autocapitalize="none" spellcheck="false" />
  <button id="btnLoad">Buscar Avatar</button>
</div>
<div id="canvas-container">
  <div id="status">Aguardando nick...</div>
</div>
<div id="animationControls" style="display:none;">
  <div class="animBtn" data-anim="idle">Idle</div>
  <div class="animBtn" data-anim="dance">Dançar</div>
  <div class="animBtn" data-anim="run">Correr</div>
</div>

<script src="https://cdn.jsdelivr.net/npm/three@0.152.2/build/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.152.2/examples/js/loaders/GLTFLoader.js"></script>

<script>
  const container = document.getElementById('canvas-container')
  const status = document.getElementById('status')
  const animControls = document.getElementById('animationControls')
  const animButtons = [...document.querySelectorAll('.animBtn')]

  let scene, camera, renderer, mixer, clock, avatarModel, currentAction

  clock = new THREE.Clock()

  function initScene() {
    scene = new THREE.Scene()
    scene.background = new THREE.Color(0x000000)
    camera = new THREE.PerspectiveCamera(45, container.clientWidth / container.clientHeight, 0.1, 1000)
    camera.position.set(0, 1.7, 3.5)

    renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true })
    renderer.setSize(container.clientWidth, container.clientHeight)
    container.appendChild(renderer.domElement)

    const light = new THREE.DirectionalLight(0xffffff, 1)
    light.position.set(0, 10, 10)
    scene.add(light)

    const ambient = new THREE.AmbientLight(0x404040, 2)
    scene.add(ambient)

    // chão simples
    const floorGeo = new THREE.PlaneGeometry(10, 10)
    const floorMat = new THREE.MeshStandardMaterial({ color: 0x111111, roughness: 1 })
    const floor = new THREE.Mesh(floorGeo, floorMat)
    floor.rotation.x = -Math.PI / 2
    floor.position.y = 0
    scene.add(floor)
  }

  function animate() {
    requestAnimationFrame(animate)
    if(mixer) mixer.update(clock.getDelta())
    renderer.render(scene, camera)
  }

  // Função confiável pra pegar UserId pela API oficial da Roblox
  async function getUserId(nick) {
    try {
      const res = await fetch(`https://users.roblox.com/v1/usernames/users`, {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({usernames: [nick]})
      })
      const data = await res.json()
      if(data && data.data && data.data.length > 0) {
        return data.data[0].id
      }
    } catch(e) {
      console.warn('Erro ao buscar UserId:', e)
    }
    return null
  }

  // Carrega o modelo 3D do avatar (demo genérico por limitação)
  async function loadAvatarModel(userId) {
    if(avatarModel){
      scene.remove(avatarModel)
      mixer = null
      avatarModel = null
    }

    status.textContent = "Carregando avatar 3D..."

    
// Modelo demo com animação idle  
const loader = new THREE.GLTFLoader()  
const demoModels = {  
  idle: "https://models.babylonjs.com/Dude/dude.gltf",  
  dance: "https://models.babylonjs.com/Soldier/Soldier.gltf",  
  run: "https://models.babylonjs.com/Warrior/Warrior.gltf"  
}  

await new Promise((resolve, reject) => {  
  loader.load(demoModels.idle, gltf => {  
    avatarModel = gltf.scene  
    avatarModel.scale.set(0.02, 0.02, 0.02)  
    scene.add(avatarModel)  

    mixer = new THREE.AnimationMixer(avatarModel)  
    currentAction = mixer.clipAction(gltf.animations[0])  
    currentAction.play()  

    resolve()  
  }, undefined, e => reject(e))  
})  

status.textContent = "Avatar carregado! (demo genérico)"  
animControls.style.display = "flex"  
}  

// Trocar animação demo  
function changeAnimation(name) {  
  if (!mixer || !avatarModel) return  
  if (currentAction) currentAction.stop()  

  const loader = new THREE.GLTFLoader()  
  const demoModels = {  
    idle: "https://models.babylonjs.com/Dude/dude.gltf",  
    dance: "https://models.babylonjs.com/Soldier/Soldier.gltf",  
    run: "https://models.babylonjs.com/Warrior/Warrior.gltf"  
  }  

  loader.load(demoModels[name], gltf => {  
    scene.remove(avatarModel)  
    avatarModel = gltf.scene  
    avatarModel.scale.set(0.02, 0.02, 0.02)  
    scene.add(avatarModel)  
    mixer = new THREE.AnimationMixer(avatarModel)  
    currentAction = mixer.clipAction(gltf.animations[0])  
    currentAction.play()  
  })  
}  

document.getElementById("btnLoad").onclick = async () => {  
  const nick = document.getElementById("inputNick").value.trim()  
  if (!nick) {  
    alert("Cola o nick aí, irmão!")  
    return  
  }  
  status.textContent = "Buscando UserId..."  
  const userId = await getUserId(nick)  
  if (!userId) {  
    status.textContent = "Nick não encontrado, tenta outro aí"  
    return  
  }  
  status.textContent = `UserId encontrado: ${userId}`  
  await loadAvatarModel(userId)  
}  

animButtons.forEach(btn => {  
  btn.onclick = () => changeAnimation(btn.dataset.anim)  
})  

initScene()  
animate()
